<%- partial('_partial/header') %> <%- partial('_partial/category-bar') %>

<div class="max-w-6xl mx-auto">
  <% var postsList = (page.posts && page.posts.length > 0) ? page.posts :
  site.posts.sort('date', -1); %>

  <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6" id="notesGrid">
    <% postsList.each(function(post){ %>
    <article
      class="note-card brutal-border bg-white p-5 relative group hover:shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] hover:-translate-y-1 transition-all flex flex-col h-full"
    >
      <div class="flex items-start justify-between mb-3 relative z-20">
        <% if (post.categories && post.categories.length > 0) { %> <% var
        catName = post.categories.data[0].name; %> <% var catColor =
        theme.category_colors && theme.category_colors[catName] ?
        theme.category_colors[catName] : 'gray'; %>
        <a
          href="<%= url_for(post.categories.data[0].path) %>"
          class="text-xs brutal-border bg-<%= catColor %>-300 px-2 py-1 font-bold hover:brightness-110"
        >
          [ <%= catName.toUpperCase() %> ]
        </a>
        <% } else { %>
        <span class="text-xs brutal-border bg-gray-200 px-2 py-1 font-bold"
          >[ NULL ]</span
        >
        <% } %>
        <span class="text-xs text-gray-500 font-bold"
          ><%= date(post.date, 'MM-DD') %></span
        >
      </div>

      <h3 class="font-bold text-xl mb-3 flex-grow">
        <a
          href="<%= url_for(post.path) %>"
          class="before:absolute before:inset-0 focus:outline-none decoration-2 underline-offset-4 group-hover:underline"
        >
          <%= post.title %>
        </a>
      </h3>

      <p class="text-sm text-gray-600 mb-4 line-clamp-3 overflow-hidden">
        <%= post.excerpt || strip_html(post.content).substring(0, 120) %>...
      </p>

      <div class="flex gap-2 flex-wrap mt-auto relative z-20">
        <% if (post.tags && post.tags.length) { %> <%
        post.tags.forEach(function(tag){ %>
        <a
          href="<%= url_for(tag.path) %>"
          class="text-[10px] border border-black px-1 hover:bg-black hover:text-white transition-colors"
        >
          #<%= tag.name %>
        </a>
        <% }) %> <% } %>
      </div>
    </article>
    <% }) %>
  </div>

  <% if (page.total > 1){ %>
  <div class="flex justify-center mt-12 gap-4">
    <%- paginator({ prev_text: '← PREV', next_text: 'NEXT →', escape: false })
    %>
  </div>
  <style>
    .page-number,
    .extend {
      border: 3px solid black;
      padding: 0.5rem 1rem;
      font-weight: bold;
      margin: 0 0.25rem;
    }
    .page-number.current {
      background: black;
      color: white;
    }
    .page-number:hover,
    .extend:hover {
      background: #fde047;
      color: black;
    }
  </style>
  <% } %>
</div>
